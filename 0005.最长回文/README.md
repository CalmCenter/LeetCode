## é¢˜ç›®

ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² `s`ï¼Œæ‰¾åˆ° `s` ä¸­æœ€é•¿çš„å›æ–‡å­ä¸²ã€‚ä½ å¯ä»¥å‡è®¾ `s` çš„æœ€å¤§é•¿åº¦ä¸º `1000`ã€‚

**ç¤ºä¾‹1:**

```
è¾“å…¥: "babad"
è¾“å‡º: "bab"
æ³¨æ„: "aba" ä¹Ÿæ˜¯ä¸€ä¸ªæœ‰æ•ˆç­”æ¡ˆã€‚
```

**ç¤ºä¾‹2:**

```
è¾“å…¥: "cbbd"
è¾“å‡º: "bb"
```

## è§£é¢˜

### æ–¹æ³•  1 ï¼šæš´åŠ›å¾ªç¯åŒ¹é… ï¼ˆBrute Forceï¼‰ğŸ’ªğŸ’ª

æ ¹æ®å›æ–‡å­ä¸²çš„å®šä¹‰ï¼Œåˆ—ä¸¾æ‰€æœ‰é•¿åº¦å¤§äºç­‰äº 2 çš„å­ä¸²ï¼Œä¾æ¬¡åˆ¤æ–­å®ƒä»¬æ˜¯å¦æ˜¯å›æ–‡ï¼›

æš´åŠ›è§£æ³•æ—¶é—´å¤æ‚åº¦é«˜ï¼Œä½†æ˜¯æ€è·¯æ¸…æ™°ã€ç¼–å†™ç®€å•ã€‚ç”±äºç¼–å†™æ­£ç¡®æ€§çš„å¯èƒ½æ€§å¾ˆå¤§ï¼Œ**å¯ä»¥ä½¿ç”¨æš´åŠ›åŒ¹é…ç®—æ³•æ£€éªŒæˆ‘ä»¬ç¼–å†™çš„å…¶å®ƒç®—æ³•æ˜¯å¦æ­£ç¡®ã€‚**ä¼˜åŒ–çš„è§£æ³•åœ¨å¾ˆå¤šæ—¶å€™ï¼Œæ˜¯åŸºäºâ€œæš´åŠ›è§£æ³•â€ï¼Œä»¥ç©ºé—´æ¢æ—¶é—´å¾—åˆ°çš„ï¼Œå› æ­¤æ€è€ƒæ¸…æ¥šæš´åŠ›è§£æ³•ï¼Œåˆ†æå…¶ç¼ºç‚¹ï¼Œå¾ˆå¤šæ—¶å€™èƒ½ä¸ºæˆ‘ä»¬æ‰“å¼€æ€è·¯ã€‚

å°†æ‰€æœ‰å­—ç¬¦èŒƒå›´éå†ä¸€éï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡ã€‚

```java
    public String longestPalindrome(String s) {
        int len = s.length();
        if (len < 2) {
            return s;
        }

        int maxLen = 1;
        int begin = 0;
        // s.charAt(i) æ¯æ¬¡éƒ½ä¼šæ£€æŸ¥æ•°ç»„ä¸‹æ ‡è¶Šç•Œï¼Œå› æ­¤å…ˆè½¬æ¢æˆå­—ç¬¦æ•°ç»„
        char[] charArray = s.toCharArray();

        // åˆ—ä¸¾æ‰€æœ‰é•¿åº¦å¤§äº 1 çš„å­ä¸² charArray[i..j]
        for (int i = 0; i < len - 1; i++) {
            for (int j = i + 1; j < len; j++) {
                if (j - i + 1 > maxLen && validPalindromic(charArray, i, j)) {
                    maxLen = j - i + 1;
                    begin = i;
                }
            }
        }
        return s.substring(begin, begin + maxLen);
    }

    /**
     * éªŒè¯å­ä¸² s[left..right] æ˜¯å¦ä¸ºå›æ–‡ä¸²
     */
    private boolean validPalindromic(char[] charArray, int left, int right) {
        while (left < right) {
            if (charArray[left] != charArray[right]) {
                return false;
            }
            left++;
            right--;
        }
        return true;
    }
```

å¤æ‚åº¦åˆ†æï¼š

æ—¶é—´å¤æ‚åº¦ï¼š*O*(N^3) é‡Œ `N` æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œæšä¸¾å­—ç¬¦ä¸²çš„å·¦è¾¹ç•Œã€å³è¾¹ç•Œï¼Œç„¶åç»§ç»­éªŒè¯å­ä¸²æ˜¯å¦æ˜¯å›æ–‡å­ä¸²ï¼Œè¿™ä¸‰ç§æ“ä½œéƒ½ä¸ `N` ç›¸å…³ï¼›
ç©ºé—´å¤æ‚åº¦ï¼š*O*(1)ï¼Œåªä½¿ç”¨åˆ°å¸¸æ•°ä¸ªä¸´æ—¶å˜é‡ï¼Œä¸å­—ç¬¦ä¸²é•¿åº¦æ— å…³ã€‚

### æ–¹æ³• 2 ï¼šä¸­å¿ƒæ‰©å±•ç®—æ³•

ç¡®è®¤ä¸­é—´çš„å­—ç¬¦ï¼Œå‘ä¸¤è¾¹å­—ç¬¦æ‰©å……æŸ¥çœ‹æ˜¯å¦æ˜¯å›æ–‡ã€‚

```java
    public String longestPalindrome(String s) {
        if (s == null || s.length() < 1) return "";
        int start = 0, end = 0;
        for (int i = 0; i < s.length(); i++) {
            //ä¸­é—´æœ‰å•ä¸ªå­—ç¬¦çš„å›æ–‡ æ¯”å¦‚ aba
            int len1 = expandAroundCenter(s, i, i);
            //ä¸­é—´æœ¬èº«å°±æ˜¯å›æ–‡çš„æƒ…å†µ æ¯”å¦‚ abba
            int len2 = expandAroundCenter(s, i, i + 1);
            int len = Math.max(len1, len2);
            if (len > end - start) {
                start = i - (len - 1) / 2;
                end = i + len / 2;
            }
        }
        return s.substring(start, end + 1);
    }

    private int expandAroundCenter(String s, int left, int right) {
        int L = left, R = right;
        while (L >= 0 && R < s.length() && s.charAt(L) == s.charAt(R)) {
            L--;
            R++;
        }
        return R - L - 1;
    }
```

å¤æ‚åº¦åˆ†æ

æ—¶é—´å¤æ‚åº¦ï¼š*O*(n^2)ï¼Œå…¶ä¸­ `n` æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚é•¿åº¦ä¸º `1` å’Œ `2` çš„å›æ–‡ä¸­å¿ƒåˆ†åˆ«æœ‰ `n` å’Œ `nâˆ’1` ä¸ªï¼Œæ¯ä¸ªå›æ–‡ä¸­å¿ƒæœ€å¤šä¼šå‘å¤–æ‰©å±• *O*(n) æ¬¡ã€‚

ç©ºé—´å¤æ‚åº¦ï¼šO(1)ã€‚

### æ–¹æ³• 3 ï¼šåŠ¨æ€è§„åˆ’

æš´åŠ›æ³•ä¼˜åŒ–ï¼ŒåŒæ ·æ˜¯éå†æ‰€æœ‰å­—ç¬¦èŒƒå›´ï¼Œä½†æ˜¯åœ¨åˆ¤æ–­å›æ–‡çš„æ—¶å€™åšäº†ä¼˜åŒ–ï¼Œæ²¡æœ‰ä½¿ç”¨ `while` å¾ªç¯ï¼Œè€Œæ˜¯åˆ¤æ–­ä¸¤è¾¹å­—ç¬¦ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œå¦‚æœå½“å‰å­—ç¬¦é•¿åº¦ > 3ï¼Œå†åˆ¤æ–­é‡Œé¢çš„å†…å®¹æ˜¯å¦æ˜¯å›æ–‡ï¼ˆé‡Œé¢çš„å­—ç¬¦å¦‚æœæ˜¯å›æ–‡ä¼šæå‰ç”¨ `T` æ ‡è®°ï¼‰ï¼Œæ¥åˆ¤æ–­å½“å‰å­—ç¬¦æ˜¯å¦æ˜¯å›æ–‡ã€‚

```java
0  1  2  3  4  5
a  b  c  c  b  a
â†‘     â†‘
S     E
```

è¿™é‡Œä½¿ç”¨åŒé‡ `for` å¾ªç¯è¡¨ç¤ºä¸¤ä¸ªæŒ‡é’ˆï¼Œæ¯æ¬¡å›ºå®š `E(end)` æŒ‡é’ˆï¼Œç„¶åéå† `E` æŒ‡é’ˆä¹‹å‰çš„æ‰€æœ‰çš„å­—ç¬¦ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰ç›¸ç­‰çš„ã€‚

è¿™é‡Œå°±ä¼šå…ˆæ‰¾åˆ°æœ€å°çš„å›æ–‡ã€‚å…·ä½“æ“ä½œå¦‚ä¸‹ã€‚

```java
    0  1  2  3  4  5
 0  T  F  F  F  F  T
 1     T  F  F  T  F
 2        T  T  F  F
 3           T  F  F
 4              T  F
 5                 T
```

ä¸ºäº†å…ˆæ‰¾åˆ°æœ€å°å›æ–‡ï¼Œè¿™é‡Œéå†äºŒç»´æ•°ç»„æ˜¯éœ€è¦æœ‰ä¸€å®šçš„é¡ºåºã€‚è¿™é‡Œåªå±•ç¤ºä¸€ç§**å·¦ä¸Šåˆ°å³ä¸‹çš„**ã€‚

é¦–å…ˆåˆ¤æ–­ `dp[0][1]` ï¼Œåˆ¤æ–­å­—ç¬¦ä¸²ç¬¬ `0` ä½å’Œç¬¬ `1` ä½æ˜¯å¦ç›¸ç­‰ã€‚ç›¸ç­‰å°±æ”¹ä¸º `T` å¦è€…å°±æ˜¯ `F` ã€‚
ç„¶åä»å·¦å¾€å³æŒ‰åˆ—éå†æ•°ç»„ã€‚ `dp[0][1]`  `dp[0][2]`  `dp[1][1]`  `dp[0][3]`  `dp[1][3]` â€¦.

è¿™é‡Œåˆ° `dp[2][3]`  çš„æ—¶å€™ç»“æœä¸º `T`ï¼Œï¼ˆ`T` è¡¨ç¤ºä¸¤ä¸ªä¸‹æ ‡æ‰€å¯¹åº”çš„å­—ç¬¦ç›¸ç­‰ï¼‰ç”±äºåªæœ‰ä¸¤ä¸ªå­—ç¬¦ï¼Œæ‰€æœ‰ä¸åšåç»­å¤„ç†ã€‚
ä½†æ˜¯åˆ°äº†  `dp[1][4]` æ˜¯åˆ¤æ–­ç»“æœä¹Ÿä¸º `T` ï¼Œå­—ç¬¦é•¿åº¦ > 3 ï¼Œå°±è¦åˆ¤æ–­å­—ç¬¦ä¸‹æ ‡ `1 å’Œ 4` ä¹‹é—´çš„å­—ç¬¦æ˜¯å¦æ˜¯å›æ–‡ã€‚`dp[1+1][4-1]` è¿™ä¸ªä¸‹æ ‡è®°å½•äº†`1 å’Œ 4` ä¹‹é—´çš„å­—ç¬¦æ˜¯å¦æ˜¯å›æ–‡ï¼Œå¾ˆæ˜¾ç„¶ç»“æœæ˜¯ `T`ã€‚
`dp[0][5]` åŒç†ï¼Œåˆ¤æ–­ `dp[1][4]` æ˜¯å¦æ˜¯ `T`ã€‚

```java
    public String longestPalindrome(String s) {
        int len = s.length();
        if (len < 2) {
            return s;
        }

        int maxLen = 1;
        int begin = 0;

        // dp[start][end] è¡¨ç¤º s[start, end] æ˜¯å¦æ˜¯å›æ–‡ä¸²
        boolean[][] dp = new boolean[len][len];
        char[] charArray = s.toCharArray();

        for (int i = 0; i < len; i++) {
            dp[i][i] = true;
        }
        for (int end = 1; end < len; end++) {
            for (int start = 0; start < end; start++) {
                //åˆ¤æ–­ä¸¤è¾¹æ˜¯å¦ç›¸ç­‰
                if (charArray[start] != charArray[end]) {
                    dp[start][end] = false;
                } else {
                    //å½“å‰å­—ç¬¦èŒƒå›´ > 3 æ‰åˆ¤æ–­å­—ç¬¦ç›´æ¥çš„å†…å®¹æ˜¯å¦æ˜¯å›æ–‡
                    if (end - start < 3) {
                        dp[start][end] = true;
                    } else {
                        //dp[start + 1][end - 1] è¡¨ç¤º s[start..end] ä¹‹é—´çš„å†…å®¹æ˜¯å¦æ˜¯å›æ–‡ã€‚
                        //è¿™é‡Œç›¸å½“äºåˆ¤æ–­ charArray[start] == charArray[end] && dp[start + 1][end - 1] == true
                        dp[start][end] = dp[start + 1][end - 1];
                    }
                }

                // åªè¦ dp[start][end] == true æˆç«‹ï¼Œå°±è¡¨ç¤ºå­ä¸² s[start..end] æ˜¯å›æ–‡ï¼Œæ­¤æ—¶è®°å½•å›æ–‡é•¿åº¦å’Œèµ·å§‹ä½ç½®
                if (dp[start][end] && end - start + 1 > maxLen) {
                    maxLen = end - start + 1;
                    begin = start;
                }
            }
        }
        return s.substring(begin, begin + maxLen);
    }
```

å¤æ‚åº¦åˆ†æ

æ—¶é—´å¤æ‚åº¦ï¼š*O*(n^2)ï¼Œå…¶ä¸­ `n` æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚åŠ¨æ€è§„åˆ’çš„çŠ¶æ€æ€»æ•°ä¸º *O*(n^2)ï¼Œå¯¹äºæ¯ä¸ªçŠ¶æ€ï¼Œæˆ‘ä»¬éœ€è¦è½¬ç§»çš„æ—¶é—´ä¸º *O*(1)ã€‚

ç©ºé—´å¤æ‚åº¦ï¼š*O*(n^2)ï¼Œå³å­˜å‚¨åŠ¨æ€è§„åˆ’çŠ¶æ€éœ€è¦çš„ç©ºé—´ã€‚

### æ–¹æ³• 4 ï¼šé©¬æ‹‰è½¦ï¼ˆManacherï¼‰ç®—æ³•

ä¸­å¿ƒæ‰©å±•ç®—æ³•ä¼˜åŒ–ï¼Œä¼˜åŒ–äº†å¥‡å¶ä¸¤ç§æƒ…å†µï¼Œä¼˜åŒ–äº† `while` å¾ªç¯çš„æ¬¡æ•°ã€‚

ä¸¾ä¸€ä¸ª `mirror` çš„ä¾‹å­ã€‚

```java
0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18
#  a  #  b  #  c  #  b  #  e  #  b  #  c  #  b  #  e  #
      â†‘        â†‘           â†‘           â†‘        â†‘
    start      m		       c           i       max
```

`m(mirror)` `c(center)` `max(maxRight)`

å½“å‰æƒ…å†µ

å°±æ˜¯å¾ªç¯ `i` ç»è¿‡ç¬¬ `5` ä½æ—¶ï¼Œå°† `p[5]` èµ‹å€¼ä¸º `3` ï¼Œè¯æ˜ä¸‹æ ‡ `5` æ˜¯å·¦å³å„æœ‰ `3` ä¸ªå­—ç¬¦çš„å›æ–‡ã€‚
ä¸‹æ ‡ `i` ç»è¿‡ç¬¬ `9` ä½ `e` æ—¶ï¼Œå°† `max` æŒ‡å‘ä¸‹æ ‡ `16` å½¢æˆæœ€é•¿å›æ–‡ `2 ~ 16` ã€‚
ç„¶å `i` ç»§ç»­å¾ªç¯ï¼Œèµ°åˆ°ä¸‹æ ‡ `13` çš„æ—¶å€™ï¼Œå½“å‰ `i < max` 
è®¡ç®— `m` çš„ä½ç½®ä¸ºä¸‹æ ‡ `5` ï¼Œ`p[5]` å†…çš„å€¼ä¸º `3`ï¼Œåˆå› ä¸º `i` å¤„äºæœ€é•¿å›æ–‡å†…ï¼Œæ‰€æœ‰ `i` çš„å‰ä¸‰åä¸‰ä½å­—ç¬¦ï¼Œå’Œä¸‹æ ‡ `m` æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥ä¸ç”¨å†å»å¾ªç¯ã€‚

```java
    public String longestPalindrome4(String s) {
        int len = s.length();
        if (len < 2) {
            return s;
        }

        // å¾—åˆ°é¢„å¤„ç†å­—ç¬¦ä¸²
        String str = addBoundaries(s, '#');
        // æ–°å­—ç¬¦ä¸²çš„é•¿åº¦
        int sLen = 2 * len + 1;

        // æ•°ç»„ p è®°å½•äº†æ‰«æè¿‡çš„å›æ–‡å­ä¸²çš„ä¿¡æ¯
        int[] p = new int[sLen];

        // åŒæŒ‡é’ˆï¼Œå®ƒä»¬æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œé¡»åŒæ—¶æ›´æ–°
        int maxRight = 0;
        int center = 0;

        // å½“å‰éå†çš„ä¸­å¿ƒæœ€å¤§æ‰©æ•£æ­¥æ•°ï¼Œå…¶å€¼ç­‰äºåŸå§‹å­—ç¬¦ä¸²çš„æœ€é•¿å›æ–‡å­ä¸²çš„é•¿åº¦
        int maxLen = 1;
        // åŸå§‹å­—ç¬¦ä¸²çš„æœ€é•¿å›æ–‡å­ä¸²çš„èµ·å§‹ä½ç½®ï¼Œä¸ maxLen å¿…é¡»åŒæ—¶æ›´æ–°
        int start = 0;

        for (int i = 0; i < sLen; i++) {
            if (i < maxRight) {
                //èƒ½èµ°åˆ°è¿™é‡Œï¼Œè¯æ˜ç°åœ¨ æœ€é•¿å›æ–‡çš„ä¸‹æ ‡ æ˜¯å¤§äº å¾ªç¯ä¸‹æ ‡ i çš„ã€‚
                //å½“å‰ä¸‹æ ‡ i å¤„äº å›æ–‡å†…éƒ¨ã€‚
                int mirror = 2 * center - i;
                // mirror çš„ä½œç”¨æ˜¯æŸ¥çœ‹ i å…³äº center æ‰€å¯¹ç§°çš„ä¸‹æ ‡(ä¹Ÿåœ¨å›æ–‡å†…éƒ¨)
                // æ˜¯å¦ä¹Ÿå­˜åœ¨å›æ–‡ p[mirror] è®°å½•äº†  ç¬¬ mirror ä½å­—ç¬¦ä¸²çš„å›æ–‡é•¿åº¦
                // mirror çš„å›æ–‡é•¿åº¦å¯¹åº”äº†å½“å‰å¾ªç¯ä¸‹æ ‡ i çš„æœ€å°å›æ–‡é•¿åº¦ï¼Œå¯ä»¥è®©å½“å‰ while å¾ªç¯å°‘å¾ªç¯å‡ æ¬¡
                p[i] = Math.min(maxRight - i, p[mirror]);
            }

            // ä¸‹ä¸€æ¬¡å°è¯•æ‰©æ•£çš„å·¦å³èµ·ç‚¹ï¼Œèƒ½æ‰©æ•£çš„æ­¥æ•°ç›´æ¥åŠ åˆ° p[i] ä¸­
            int left = i - (1 + p[i]);
            int right = i + (1 + p[i]);

            // left >= 0 && right < sLen ä¿è¯ä¸è¶Šç•Œ
            // str.charAt(left) == str.charAt(right) è¡¨ç¤ºå¯ä»¥æ‰©æ•£ 1 æ¬¡
            while (left >= 0 && right < sLen && str.charAt(left) == str.charAt(right)) {
                p[i]++;
                left--;
                right++;

            }
            // æ ¹æ® maxRight çš„å®šä¹‰ï¼Œå®ƒæ˜¯éå†è¿‡çš„ i çš„ i + p[i] çš„æœ€å¤§è€…
            // å¦‚æœ maxRight çš„å€¼è¶Šå¤§ï¼Œè¿›å…¥ä¸Šé¢ i < maxRight çš„åˆ¤æ–­çš„å¯èƒ½æ€§å°±è¶Šå¤§ï¼Œè¿™æ ·å°±å¯ä»¥é‡å¤åˆ©ç”¨ä¹‹å‰åˆ¤æ–­è¿‡çš„å›æ–‡ä¿¡æ¯äº†
            if (i + p[i] > maxRight) {
                // maxRight å’Œ center éœ€è¦åŒæ—¶æ›´æ–°
                maxRight = i + p[i];
                center = i;
            }
            if (p[i] > maxLen) {
                // è®°å½•æœ€é•¿å›æ–‡å­ä¸²çš„é•¿åº¦å’Œç›¸åº”å®ƒåœ¨åŸå§‹å­—ç¬¦ä¸²ä¸­çš„èµ·ç‚¹
                maxLen = p[i];
                start = (i - maxLen) / 2;
            }
        }
        return s.substring(start, start + maxLen);
    }


    /**
     * åˆ›å»ºé¢„å¤„ç†å­—ç¬¦ä¸²
     *
     * @param s      åŸå§‹å­—ç¬¦ä¸²
     * @param divide åˆ†éš”å­—ç¬¦
     * @return ä½¿ç”¨åˆ†éš”å­—ç¬¦å¤„ç†ä»¥åå¾—åˆ°çš„å­—ç¬¦ä¸²
     */
    private String addBoundaries(String s, char divide) {
        int len = s.length();
        if (len == 0) {
            return "";
        }
        if (s.indexOf(divide) != -1) {
            throw new IllegalArgumentException("å‚æ•°é”™è¯¯ï¼Œæ‚¨ä¼ é€’çš„åˆ†å‰²å­—ç¬¦ï¼Œåœ¨è¾“å…¥å­—ç¬¦ä¸²ä¸­å­˜åœ¨ï¼");
        }
        StringBuilder stringBuilder = new StringBuilder();
        for (int i = 0; i < len; i++) {
            stringBuilder.append(divide);
            stringBuilder.append(s.charAt(i));
        }
        stringBuilder.append(divide);
        return stringBuilder.toString();
    }
```

å¤æ‚åº¦åˆ†æ

æ—¶é—´å¤æ‚åº¦ï¼š*O*(n)ï¼Œå…¶ä¸­ n æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚ç”±äºå¯¹äºæ¯ä¸ªä½ç½®ï¼Œæ‰©å±•è¦ä¹ˆä»å½“å‰çš„æœ€å³ä¾§è‡‚é•¿ `right` å¼€å§‹ï¼Œè¦ä¹ˆåªä¼šè¿›è¡Œä¸€æ­¥ï¼Œè€Œ `right` æœ€å¤šå‘å‰èµ° *O*(n) æ­¥ï¼Œå› æ­¤ç®—æ³•çš„å¤æ‚åº¦ä¸º *O*(n)ã€‚

ç©ºé—´å¤æ‚åº¦ï¼š*O*(n)ï¼Œæˆ‘ä»¬éœ€è¦ *O*(n) çš„ç©ºé—´è®°å½•æ¯ä¸ªä½ç½®çš„è‡‚é•¿ã€‚

